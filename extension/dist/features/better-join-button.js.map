{"version":3,"file":"better-join-button.js","sources":["../../src/features/better-join-button.js"],"sourcesContent":["import { getFeatureID } from '../helpers/feature-helpers.js';\r\nimport features from '../feature-manager.js';\r\nimport { findProps } from '../helpers/react-resolver.js';\r\nimport { $ } from 'select-dom';\r\nimport './better-join-button.css';\r\n\r\nconst selector = '.css-77mr2t .btn-success';\r\nlet persistInterval = 0;\r\n\r\nconst userRoles = {\r\n    0: \"Race\",\r\n    2: \"üëÄ Spectate\",\r\n    4: \"üì£ Spot\"\r\n};\r\n\r\nasync function init(activate = true) {\r\n\r\n    if (!activate) {\r\n        clearInterval(persistInterval);\r\n        return;\r\n    }\r\n\r\n    persistInterval = setInterval(() => {\r\n        let joinBtnEl = $(selector);\r\n\r\n        if (joinBtnEl.classList.contains('iref-seen')) {\r\n            return;\r\n        }\r\n\r\n        joinBtnEl.classList.add('iref-seen');\r\n    \r\n        const joinProps = findProps(joinBtnEl);\r\n\r\n        let label1 = \"\";\r\n        let label2 = \"\";\r\n\r\n        if (joinProps.registrationStatus.user_role !== 0) {\r\n            if(userRoles[joinProps.registrationStatus.user_role] !== undefined) {\r\n                label1 = userRoles[joinProps.registrationStatus.user_role];\r\n            }\r\n        } else {\r\n            if (joinProps.registrationStatus.event_type === 5) {\r\n                label2 = \" Race\";\r\n            } else {\r\n                label2 = \" Practice\";\r\n            }\r\n\r\n            if (joinProps.registrationStatus.will_be_scored) {\r\n                label1 = \"Official\";\r\n            } else {\r\n                label1 = \"Unofficial\";\r\n            }\r\n        }\r\n\r\n        //joinBtnEl.innerHTML = joinBtnEl.innerHTML + \" \" + label;\r\n        joinBtnEl.innerHTML = (label2 ? \"üèÅ Join \" : \"\") + label1 + label2;\r\n\r\n    }, 300);\r\n}\r\n\r\nconst id = getFeatureID(import.meta.url);\r\nconst bodyClass = 'iref-' + id;\r\n\r\nfeatures.add(id, true, selector, bodyClass, init);\r\n"],"names":["selector","persistInterval","userRoles","init","activate","joinBtnEl","$","joinProps","findProps","label1","label2","id","getFeatureID","bodyClass","features"],"mappings":";;;;;AAMA,MAAMA,IAAW;AACjB,IAAIC,IAAkB;AAEtB,MAAMC,IAAY;AAAA,EACd,GAAG;AAAA,EACH,GAAG;AAAA,EACH,GAAG;AACP;AAEA,eAAeC,EAAKC,IAAW,IAAM;AAEjC,MAAI,CAACA,GAAU;AACX,kBAAcH,CAAe;AAC7B;AAAA,EACH;AAED,EAAAA,IAAkB,YAAY,MAAM;AAChC,QAAII,IAAYC,EAAEN,CAAQ;AAE1B,QAAIK,EAAU,UAAU,SAAS,WAAW;AACxC;AAGJ,IAAAA,EAAU,UAAU,IAAI,WAAW;AAEnC,UAAME,IAAYC,EAAUH,CAAS;AAErC,QAAII,IAAS,IACTC,IAAS;AAEb,IAAIH,EAAU,mBAAmB,cAAc,IACxCL,EAAUK,EAAU,mBAAmB,SAAS,MAAM,WACrDE,IAASP,EAAUK,EAAU,mBAAmB,SAAS,MAGzDA,EAAU,mBAAmB,eAAe,IAC5CG,IAAS,UAETA,IAAS,aAGTH,EAAU,mBAAmB,iBAC7BE,IAAS,aAETA,IAAS,eAKjBJ,EAAU,aAAaK,IAAS,aAAa,MAAMD,IAASC;AAAA,EAE/D,GAAE,GAAG;AACV;AAEA,MAAMC,IAAKC,EAAa,YAAY,GAAG,GACjCC,IAAY,UAAUF;AAE5BG,EAAS,IAAIH,GAAI,IAAMX,GAAUa,GAAWV,CAAI;"}