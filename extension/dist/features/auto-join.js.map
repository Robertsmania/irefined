{"version":3,"file":"auto-join.js","sources":["../../src/features/auto-join.js"],"sourcesContent":["import { getFeatureID } from '../helpers/feature-helpers.js';\r\nimport { log } from './logger.js';\r\nimport features from '../feature-manager.js';\r\nimport { findProps } from '../helpers/react-resolver.js';\r\nimport { $ } from 'select-dom';\r\n\r\nconst selector = '.css-77mr2t .btn-success';\r\n\r\nlet lastJoined;\r\n\r\nasync function init(activate = true) {\r\n\r\n    if (!activate) {\r\n        return;\r\n    }\r\n\r\n    let type = JSON.parse(localStorage.getItem('iref_settings'))[\"auto-join-type\"] || \"race\";\r\n\r\n    const joinProps = findProps($(selector));\r\n\r\n    if (joinProps.registrationStatus.subsession_id !== lastJoined) {\r\n        lastJoined = joinProps.registrationStatus.subsession_id;\r\n        if (type !== \"race\" || (type === \"race\" && joinProps.registrationStatus.event_type === 5  && joinProps.registrationStatus.will_be_scored)) {\r\n            log(`üèÅ Auto joined session: ${lastJoined}`);\r\n            $(selector).click();\r\n        } else {\r\n            log(`‚õî Not joining non-race session: ${lastJoined}`);\r\n        }\r\n    } else {\r\n        log(`‚õî Already processed auto join for: ${lastJoined}`);\r\n    }\r\n}\r\n\r\nconst id = getFeatureID(import.meta.url);\r\nconst bodyClass = 'iref-' + id;\r\n\r\nfeatures.add(id, true, selector, bodyClass, init);\r\n"],"names":["selector","lastJoined","init","activate","type","joinProps","findProps","$","log","id","getFeatureID","bodyClass","features"],"mappings":";;;;;AAMA,MAAMA,IAAW;AAEjB,IAAIC;AAEJ,eAAeC,EAAKC,IAAW,IAAM;AAEjC,MAAI,CAACA;AACD;AAGJ,MAAIC,IAAO,KAAK,MAAM,aAAa,QAAQ,eAAe,CAAC,EAAE,gBAAgB,KAAK;AAElF,QAAMC,IAAYC,EAAUC,EAAEP,CAAQ,CAAC;AAEvC,EAAIK,EAAU,mBAAmB,kBAAkBJ,KAC/CA,IAAaI,EAAU,mBAAmB,eACtCD,MAAS,UAAWA,MAAS,UAAUC,EAAU,mBAAmB,eAAe,KAAMA,EAAU,mBAAmB,kBACtHG,EAAI,2BAA2BP,CAAU,EAAE,GAC3CM,EAAEP,CAAQ,EAAE,WAEZQ,EAAI,mCAAmCP,CAAU,EAAE,KAGvDO,EAAI,sCAAsCP,CAAU,EAAE;AAE9D;AAEA,MAAMQ,IAAKC,EAAa,YAAY,GAAG,GACjCC,IAAY,UAAUF;AAE5BG,EAAS,IAAIH,GAAI,IAAMT,GAAUW,GAAWT,CAAI;"}